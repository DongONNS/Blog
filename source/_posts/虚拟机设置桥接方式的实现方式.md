---
title: 虚拟机设置桥接方式的实现方式
date: 2020-11-14 15:10:24
tags:
categories: Linux
---

&emsp;&emsp;最近在学习elasticsearch,es是部署在centos虚拟机上的，我在虚拟机上起了es之后需要验证一些检索方式，可是我的宿主机连不通我的虚拟机，于是我就把虚拟机的网络连接方式改为了桥接模式，这篇文章主要是记录一下修改连接方式时的一些所学。

<!--more-->

## 一、虚拟机的网络连接方式
&emsp;&emsp;vmware为我们提供了三种网络工作模式，它们分别是：**Bridged（桥接模式）、NAT（网络地址转换模式）、Host-Only（仅主机模式）。**下图中的VMnet0表示的是用于桥接模式下的虚拟交换机；VMnet1表示的是用于仅主机模式下的虚拟交换机；VMnet8表示的是用于NAT模式下的虚拟交换机。

![虚拟机网络连接方式](http://ww1.sinaimg.cn/large/006JSCholy1gkoqrepjbyj30j10i4mxo.jpg)

### 1.1桥接模式
&emsp;&emsp;桥接模式就是将主机网卡与虚拟机虚拟的网卡利用虚拟网桥进行通信。在桥接的作用下，类似于把物理主机虚拟为一个交换机，所有桥接设置的虚拟机连接到这个交换机的一个接口上，物理主机也同样插在这个交换机当中，所以所有桥接下的网卡与网卡都是交换模式的，相互可以访问而不干扰。在桥接模式下，虚拟机ip地址需要与主机在同一个网段，如果需要联网，则网关与DNS需要与主机网卡一致。
![桥接模式](http://ww1.sinaimg.cn/large/006JSCholy1gkoraueurxj30ny0m1q8w.jpg)

### 1.2NAT模式
&emsp;&emsp;NAT，是Network Address Translation的缩写，意即网络地址转换。NAT模式也是VMware创建虚拟机的默认网络连接模式。使用NAT模式网络连接时，VMware会在主机上建立单独的专用网络，用以在主机和虚拟机之间相互通信。虚拟机向外部网络发送的请求数据"包裹"，都会交由NAT网络适配器加上"特殊标记"并以主机的名义转发出去，外部网络返回的响应数据"包裹"，也是先由主机接收，然后交由NAT网络适配器根据"特殊标记"进行识别并转发给对应的虚拟机，因此，虚拟机在外部网络中不必具有自己的IP地址。从外部网络来看，虚拟机和主机在共享一个IP地址，默认情况下，外部网络终端也无法访问到虚拟机。

&emsp;&emsp;此外，在一台主机上只允许有一个NAT模式的虚拟网络。因此，同一台主机上的多个采用NAT模式网络连接的虚拟机也是可以相互访问的。

&emsp;&emsp;前面我们已经提到，默认情况下，外部网络无法访问到虚拟机，不过我们也可以通过手动修改NAT设置实现端口转发功能，将外部网络发送到主机指定端口的数据转发到指定的虚拟机上。比如，我们在虚拟机的80端口上"建立"了一个站点，只要我们设置端口转发，将主机88端口上的数据转发给虚拟机的80端口，就可以让外部网络通过主机的88端口访问到虚拟机80端口上的站点。

![NAT模式](http://ww1.sinaimg.cn/large/006JSCholy1gkos0y1m2bj30py0knwk0.jpg)

### 1.3 仅主机模式
&emsp;&emsp;仅主机模式，是一种比NAT模式更加封闭的的网络连接模式，它将创建完全包含在主机中的专用网络。仅主机模式的虚拟网络适配器仅对主机可见，并在虚拟机和主机系统之间提供网络连接。相对于NAT模式而言，仅主机模式不具备NAT功能，因此在默认情况下，使用仅主机模式网络连接的虚拟机无法连接到Internet(在主机上安装合适的路由或代理软件，或者在Windows系统的主机上使用Internet连接共享功能，仍然可以让虚拟机连接到Internet或其他网络)。

&emsp;&emsp;在同一台主机上可以创建多个仅主机模式的虚拟网络，如果多个虚拟机处于同一个仅主机模式网络中，那么它们之间是可以相互通信的；如果它们处于不同的仅主机模式网络，则默认情况下无法进行相互通信(可通过在它们之间设置路由器来实现相互通信)。

## 二、设置centos7为连接方式为桥接模式
### 2.1 设置vmware

### 2.2 设置虚拟机




## 三、ping协议总结

